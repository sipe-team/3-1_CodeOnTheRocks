# 권기현 - 2주차 😎

## 들어가며,,
이제 슬슬 연말이라 회사에서도 평가 기간이 되고있습니다,, 그동안 미뤄두었던 OKR을 조금씩 진행 중이었는데 이번주는 업무랑 별개로 스터디도 할 겸 개인시간을 Flavor 적용하는데 시간을 많이 써서 해당 내용 중점으로 작업 기록을 남겨보겠습니다!

## Flavor
Flavor는 하나의 소스코드로 두개 이상의 패키지네임을 가진 별개의 앱을 빌드 하기 위해 필요한 개념인데요 지금 회사에서는 팀 내에서 마켓 앱과 같은 패키지 네임을 가진 앱을 CDN에 배포하고 있어서 마켓앱과 개발앱을 동시에 설치할 수 없는 상황입니다.    

그래서 개발앱 / 상용앱 을 분리 설치가능하게 작업해 별도의 번거로운 삭제/설치 혹은 서버 변경 작업 없이 바로 테스트가 가능하게 했고 또한 현재 회사에서 B2B 서비스를 중점으로 가져가고 있는데 추후 같은 소스로 B2C 서비스를 따로 배포할 가능성도 있어 꼭 필요한 기술검토였습니다.

저는 Flutter를 통해 개발을 하고있어서 이미 하나의 소스코드로 Android / IOS / Web 환경에 배포가 되어있는 상태라 어느 한군데도 문제 안생기게끔 동시에 작업을 진행을 했어야 했습니다. 각 플랫폼에 대해 겪었던 어려움과 해결과정은 다음과 같습니다.

### 1. Android  
* 기존 기능중 로그인하면 고객사별로 앱 아이콘을 변경하는 기능이 있는데 안됨  
-> AndroidManifest.xml 파일을 빌드 환경별로 만들어서 직접 패키지 네임을 지정해줌

### 2. IOS
* 그냥 빌드 환경 분리 자체가 빡셈  
-> IOS는 Flavor 라는 개념이 따로 있는건 아니고 Scheme을 분리하고 빌드셋팅을 열심히  찢어주는 작업이라 Xcode랑 씨름을 많이 했습니다 ㅎㅎ,,
* 인증서 이슈  
-> IOS는 Bundle ID를 다르게 셋팅해야 해서 인증서를 별도로 만들어주고 CI/CD 적용할때도 별도로 셋팅을 해줬어야했음
* Share Scheme  
-> Fastlane 으로 CDN 배포시 만들어둔 Scheme이 인식이 안되어서 한참 고민하고보니 Xcode에 Share로 셋팅하는 옵션이 따로 있어서 그걸 꼭 해줘야 하는거였음,,

### 3. Web
* 딥링크 이슈  
-> 현재 회사 서비스에서 웹도 dev용 url이 따로 있는데 빌드 환경 분리를 하면서 상용앱, 개발앱이 모두 깔려있을때 링크 클릭시 상용웹에서는 상용앱이 열리고, 개발웹에서는 개발앱이 열려야 했음, 이 문제는 웹 배포시 사용되는 bitbucket pipeline 안에 각 환경에 맞는 파일을 생성시켜 배포하는 방법으로 해결
